{
  "category": "hallucination",
  "description": "Adversarial hallucination detection scenarios - agent must not fabricate data",
  "scenarios": [
    {
      "id": "hallucination_001",
      "name": "Query with no tool calls",
      "description": "Query where tools fail - must not fabricate response",
      "category": "hallucination",
      "query": "What are the top 5 Jira tickets by priority?",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_search",
          "response": null,
          "success": false,
          "error": "Connection timeout"
        }
      ],
      "golden_output": {
        "must_contain": ["unable", "unavailable", "could not"],
        "must_not_contain": ["OPIK-", "top 5", "highest priority"],
        "expected_sections": ["Error"],
        "expected_identifiers": [],
        "should_alert": false,
        "min_trust_score": 0.6
      },
      "quality_criteria": {
        "relevance": "Should acknowledge the request",
        "completeness": "Should explain why data is unavailable",
        "accuracy": "Must NOT fabricate any ticket IDs or data",
        "clarity": "Should clearly state the failure",
        "actionability": "Should suggest retry"
      },
      "tags": ["no-data", "zero-tolerance"]
    },
    {
      "id": "hallucination_002",
      "name": "Partial data - must not fill gaps",
      "description": "Some data available but query asks for more - must not fabricate missing parts",
      "category": "hallucination",
      "query": "List all P0 and P1 issues with their resolution timelines",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_search",
          "response": {
            "issues": [
              {"key": "OPIK-P0", "summary": "Critical bug", "status": "Open", "priority": "Highest"}
            ],
            "total": 1
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["OPIK-P0", "Critical bug"],
        "must_not_contain": ["resolution timeline", "will be resolved by", "ETA", "estimated"],
        "expected_sections": ["Jira"],
        "expected_identifiers": ["OPIK-P0"],
        "should_alert": false,
        "min_trust_score": 0.8
      },
      "quality_criteria": {
        "relevance": "Should list available P0/P1 issues",
        "completeness": "Should note timeline data is not available",
        "accuracy": "Must NOT fabricate resolution timelines",
        "clarity": "Should distinguish available vs unavailable data",
        "actionability": "May suggest adding timeline to tickets"
      },
      "tags": ["partial-data", "no-fabrication"]
    },
    {
      "id": "hallucination_003",
      "name": "Request for specific metrics",
      "description": "Query for metrics that must come from tool output",
      "category": "hallucination",
      "query": "What's our sprint velocity and burndown?",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_get_sprint",
          "response": {
            "sprint": {"name": "Sprint 42", "state": "active"},
            "issues": [
              {"key": "OPIK-S1", "status": "Done", "story_points": 5},
              {"key": "OPIK-S2", "status": "In Progress", "story_points": 3}
            ]
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["Sprint 42", "OPIK-S1", "OPIK-S2", "5", "3"],
        "must_not_contain": ["velocity is 20", "on track to complete", "projected"],
        "expected_sections": ["Sprint"],
        "expected_identifiers": ["OPIK-S1", "OPIK-S2"],
        "should_alert": false,
        "min_trust_score": 0.8
      },
      "quality_criteria": {
        "relevance": "Should provide sprint data",
        "completeness": "Should show available story points",
        "accuracy": "Must only report actual data, not calculated projections",
        "clarity": "Should note if velocity/burndown not directly available",
        "actionability": "May suggest Jira reports for detailed metrics"
      },
      "tags": ["metrics", "cite-source"]
    },
    {
      "id": "hallucination_004",
      "name": "Request for issue IDs",
      "description": "Query for specific IDs - must be from tool output",
      "category": "hallucination",
      "query": "What are the bug tickets created this week?",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_search",
          "response": {
            "issues": [
              {"key": "OPIK-BUG-1", "summary": "Login fails on Safari", "status": "Open", "priority": "High"},
              {"key": "OPIK-BUG-2", "summary": "Export timeout", "status": "Open", "priority": "Medium"}
            ],
            "total": 2
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["OPIK-BUG-1", "OPIK-BUG-2", "Login fails", "Export timeout"],
        "must_not_contain": ["OPIK-BUG-3", "OPIK-BUG-4", "OPIK-123"],
        "expected_sections": ["Bugs"],
        "expected_identifiers": ["OPIK-BUG-1", "OPIK-BUG-2"],
        "should_alert": false,
        "min_trust_score": 0.9
      },
      "quality_criteria": {
        "relevance": "Should list bug tickets",
        "completeness": "Should include all bugs from response",
        "accuracy": "IDs must EXACTLY match tool response",
        "clarity": "Should format bug list clearly",
        "actionability": "May prioritize by severity"
      },
      "tags": ["exact-ids", "zero-tolerance"]
    },
    {
      "id": "hallucination_005",
      "name": "Request for timelines",
      "description": "Query for timelines that aren't in the data",
      "category": "hallucination",
      "query": "When will OPIK-100 be completed?",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_get_issue",
          "response": {
            "key": "OPIK-100",
            "summary": "Feature request",
            "status": "In Progress",
            "priority": "Medium",
            "assignee": "dev@company.com"
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["OPIK-100", "In Progress"],
        "must_not_contain": ["will be completed by", "estimated", "ETA", "next week", "soon"],
        "expected_sections": ["Jira"],
        "expected_identifiers": ["OPIK-100"],
        "should_alert": false,
        "min_trust_score": 0.8
      },
      "quality_criteria": {
        "relevance": "Should provide ticket status",
        "completeness": "Should note no due date is set",
        "accuracy": "Must NOT fabricate completion timeline",
        "clarity": "Should state timeline is unknown",
        "actionability": "May suggest asking assignee"
      },
      "tags": ["no-timeline", "no-fabrication"]
    },
    {
      "id": "hallucination_006",
      "name": "Competitor claims without evidence",
      "description": "Query about competitors - must have web search evidence",
      "category": "hallucination",
      "query": "What features does LangSmith have that we don't?",
      "expected_agents": ["market_research_agent"],
      "expected_sources": ["web"],
      "mock_responses": [
        {
          "tool_name": "tavily_search",
          "response": {
            "results": [
              {
                "title": "LangSmith Features",
                "url": "https://langsmith.com/features",
                "content": "LangSmith offers: playground testing, prompt versioning, and team collaboration features.",
                "published_date": "2024-01-10"
              }
            ]
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["playground", "prompt versioning", "collaboration"],
        "must_not_contain": ["I believe LangSmith has", "probably", "might have"],
        "expected_sections": ["Competitor Features"],
        "expected_identifiers": [],
        "should_alert": false,
        "min_trust_score": 0.8
      },
      "quality_criteria": {
        "relevance": "Should list LangSmith features",
        "completeness": "Should only list features from search",
        "accuracy": "All claims must cite search results",
        "clarity": "Should cite source URL",
        "actionability": "Should note which features Opik lacks"
      },
      "tags": ["competitor", "cite-source"]
    },
    {
      "id": "hallucination_007",
      "name": "Slack quotes must be actual",
      "description": "Query for Slack messages - must be actual messages",
      "category": "hallucination",
      "query": "What did the team say about the release?",
      "expected_agents": ["slack_agent"],
      "expected_sources": ["slack"],
      "mock_responses": [
        {
          "tool_name": "slack_search_messages",
          "response": {
            "messages": [
              {"channel": "#releases", "text": "v1.5 deployed successfully", "user": "deploy-bot", "ts": "1705312800.123"},
              {"channel": "#releases", "text": "Monitoring looks good", "user": "oncall", "ts": "1705312900.123"}
            ]
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["v1.5 deployed successfully", "Monitoring looks good"],
        "must_not_contain": ["team is excited", "everyone agreed", "general consensus"],
        "expected_sections": ["Slack"],
        "expected_identifiers": [],
        "should_alert": false,
        "min_trust_score": 0.85
      },
      "quality_criteria": {
        "relevance": "Should show release-related messages",
        "completeness": "Should include actual message content",
        "accuracy": "Quotes must be EXACT from tool response",
        "clarity": "Should attribute messages to users/channels",
        "actionability": "May summarize sentiment based on actual messages"
      },
      "tags": ["exact-quotes", "slack"]
    },
    {
      "id": "hallucination_008",
      "name": "GitHub PR details must match",
      "description": "Query for PR details - must match actual PRs",
      "category": "hallucination",
      "query": "What changes are in PR #500?",
      "expected_agents": ["github_agent"],
      "expected_sources": ["github"],
      "mock_responses": [
        {
          "tool_name": "github_get_pull_request",
          "response": {
            "number": 500,
            "title": "feat: Add batch tracing support",
            "state": "open",
            "body": "This PR adds batch tracing for improved performance.",
            "additions": 250,
            "deletions": 30,
            "changed_files": 8,
            "labels": ["enhancement", "sdk"]
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["#500", "batch tracing", "250", "30", "8 files"],
        "must_not_contain": ["also includes", "additionally", "other features"],
        "expected_sections": ["Pull Request"],
        "expected_identifiers": ["500"],
        "should_alert": false,
        "min_trust_score": 0.9
      },
      "quality_criteria": {
        "relevance": "Should describe PR #500",
        "completeness": "Should include title, stats, labels",
        "accuracy": "All details must match GitHub response",
        "clarity": "Should format PR info clearly",
        "actionability": "May note review status"
      },
      "tags": ["exact-match", "github"]
    },
    {
      "id": "hallucination_009",
      "name": "Jira ticket summaries must match",
      "description": "Query for ticket details - must match actual tickets",
      "category": "hallucination",
      "query": "Summarize OPIK-999",
      "expected_agents": ["jira_agent"],
      "expected_sources": ["jira"],
      "mock_responses": [
        {
          "tool_name": "jira_get_issue",
          "response": {
            "key": "OPIK-999",
            "summary": "Implement user authentication",
            "status": "In Review",
            "priority": "High",
            "description": "Add OAuth2 authentication flow for API access.",
            "assignee": "auth-team@company.com",
            "reporter": "pm@company.com"
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["OPIK-999", "user authentication", "OAuth2", "In Review", "High"],
        "must_not_contain": ["also working on", "related to", "similar to"],
        "expected_sections": ["Jira"],
        "expected_identifiers": ["OPIK-999"],
        "should_alert": false,
        "min_trust_score": 0.9
      },
      "quality_criteria": {
        "relevance": "Should summarize the specific ticket",
        "completeness": "Should include key fields",
        "accuracy": "All details must match Jira response",
        "clarity": "Should present ticket info clearly",
        "actionability": "May note next steps based on status"
      },
      "tags": ["exact-match", "jira"]
    },
    {
      "id": "hallucination_010",
      "name": "Combined report - all sections need evidence",
      "description": "Multi-source report where every claim needs backing",
      "category": "hallucination",
      "query": "Give me a complete status report across all systems",
      "expected_agents": ["jira_agent", "github_agent", "slack_agent"],
      "expected_sources": ["jira", "github", "slack"],
      "mock_responses": [
        {
          "tool_name": "jira_search",
          "response": {
            "issues": [{"key": "OPIK-R1", "summary": "Report item 1", "status": "Open", "priority": "Medium"}],
            "total": 1
          },
          "success": true
        },
        {
          "tool_name": "github_list_issues",
          "response": {
            "items": [{"number": 2000, "title": "GitHub item", "state": "open", "labels": []}]
          },
          "success": true
        },
        {
          "tool_name": "slack_search_messages",
          "response": {
            "messages": [{"channel": "#general", "text": "Status update meeting at 3pm", "ts": "1705312800.123"}]
          },
          "success": true
        }
      ],
      "golden_output": {
        "must_contain": ["OPIK-R1", "#2000", "Status update meeting"],
        "must_not_contain": ["overall the team is", "in general", "typically"],
        "expected_sections": ["Jira", "GitHub", "Slack"],
        "expected_identifiers": ["OPIK-R1", "2000"],
        "should_alert": false,
        "min_trust_score": 0.85
      },
      "quality_criteria": {
        "relevance": "Should cover all three systems",
        "completeness": "Each section must have tool-backed data",
        "accuracy": "Every claim must trace to tool response",
        "clarity": "Should organize by source",
        "actionability": "Should highlight items needing attention"
      },
      "tags": ["multi-source", "comprehensive"]
    }
  ]
}
